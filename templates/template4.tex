% Template 4: Academic Research Design (Based on raw3)
% This template provides comprehensive academic document styling with consistent design
% throughout all pages, including backgrounds, headers, footers, and section formatting.

% ========== TEMPLATE CONFIGURATION ==========
% Load additional required packages for this template
% Note: tikz, eso-pic, xcolor already loaded in config.tex
\usepackage{tcolorbox}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{tocloft}
\usepackage{setspace}

% ========== TEMPLATE PLACEHOLDER DEFAULTS ==========
% Provide default values for placeholders used in headers/footers
% These will be overridden by main.tex definitions if they exist
\providecommand{\InstitutionPlaceholder}{Your Institution}
\providecommand{\DepartmentPlaceholder}{Your Department}
\providecommand{\DocumentIDPlaceholder}{DOC-001}
\providecommand{\VersionPlaceholder}{1.0}
\providecommand{\ClassificationPlaceholder}{Internal}
\providecommand{\DistributionPlaceholder}{Restricted}
\providecommand{\StatusPlaceholder}{Draft}
\providecommand{\ContactPlaceholder}{contact@institution.edu}

% ========== TEMPLATE COLORS ==========
% Define template-specific colors that integrate with brand system
\definecolor{templatePrimary}{RGB}{0,51,102}      % Deep blue (from raw3 primaryblue)
\definecolor{templateAccent}{RGB}{51,122,183}     % Accent blue (from raw3 accentblue)
\definecolor{templateGold}{RGB}{255,193,7}        % Gold accent (from raw3 goldaccent)
\definecolor{templateDark}{RGB}{64,64,64}         % Dark gray (from raw3 darkgray)
\definecolor{templateLight}{RGB}{240,240,240}     % Light gray (from raw3 lightgray)

% ========== BACKGROUND DESIGN FOR ALL PAGES ==========
% Consistent background elements across all pages (from raw3)
\AddToShipoutPictureBG{%
\begin{tikzpicture}[remember picture,overlay]
    % Top right decorative circle
    \node[circle, fill=templatePrimary!8, minimum size=8cm] at ([xshift=-2cm,yshift=3cm]current page.north east) {};
    % Bottom left decorative circle
    \node[circle, fill=templateGold!12, minimum size=5cm] at ([xshift=3cm,yshift=-3cm]current page.south west) {};
    % Subtle accent line top
    \draw[templateAccent!20, line width=2pt] ([yshift=-0.8cm]current page.north west) -- ([yshift=-0.8cm]current page.north east);
    % Subtle accent line bottom
    \draw[templateAccent!20, line width=2pt] ([yshift=0.8cm]current page.south west) -- ([yshift=0.8cm]current page.south east);
\end{tikzpicture}
}

% ========== SECTION FORMATTING ==========
% Custom section styling with colored backgrounds (from raw3)
\titleformat{\section}
{\Large\bfseries\color{white}}
{\thesection}{1em}{}
[\vspace{-0.7cm}]

\titleformat{\subsection}
{\large\bfseries\color{templatePrimary}}
{\thesubsection}{1em}{}
[\textcolor{templateAccent!40}{\titlerule[0.8pt]}]

\titleformat{\subsubsection}
{\normalsize\bfseries\color{templateAccent}}
{\thesubsubsection}{1em}{}

% Custom section command with background (from raw3)
\let\oldsection\section
\renewcommand{\section}[1]{%
\vspace{0.3cm}
\noindent\begin{tcolorbox}[colback=templatePrimary,colframe=templatePrimary,arc=4pt,boxrule=0pt,left=10pt,right=10pt,top=8pt,bottom=8pt,width=\textwidth]
\oldsection*{#1}
\end{tcolorbox}
\vspace{0.2cm}
}

% ========== HEADER AND FOOTER DESIGN ==========
% Professional headers and footers with design elements (from raw3)
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{%
\begin{tikzpicture}[remember picture,overlay]
\node[rectangle,fill=templateAccent!15,rounded corners=3pt,minimum height=0.6cm,minimum width=3cm,anchor=west] at (0,0) {};
\end{tikzpicture}
\hspace{0.2cm}\textcolor{templatePrimary}{\small\textbf{\CoverTitle}}
}
\fancyhead[R]{%
\textcolor{templateDark}{\small \InstitutionPlaceholder}
\begin{tikzpicture}[remember picture,overlay]
\node[circle,fill=templateGold!20,minimum size=0.5cm,anchor=east] at (0.3,0) {};
\end{tikzpicture}
}
\fancyfoot[C]{%
\begin{tikzpicture}
\node[circle,fill=templatePrimary!15,inner sep=6pt] {\textcolor{templatePrimary}{\textbf{\thepage}}};
\end{tikzpicture}
}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% ========== TABLE OF CONTENTS STYLING ==========
% Enhanced table of contents with brand colors (from raw3)
\renewcommand{\cftsecfont}{\bfseries\color{templatePrimary}}
\renewcommand{\cftsubsecfont}{\color{templateDark}}
\renewcommand{\cftsecpagefont}{\bfseries\color{templatePrimary}}
\renewcommand{\cftsubsecpagefont}{\color{templateDark}}

% ========== LINE SPACING ==========
% Set document line spacing
\onehalfspacing

% ========== COVER PAGE MACRO ==========
% Define a command for generating the academic cover page (based on raw3 title page)
\newcommand{\templateFourCover}[5]{%
  % #1: Document Title
  % #2: Document Subtitle  
  % #3: Year
  % #4: Submitted to (recipient)
  % #5: Prepared by (author)
  \begin{titlepage}
  \newgeometry{margin=0.7in}
  \thispagestyle{empty}
  
  % Enhanced background for title page (from raw3)
  \begin{tikzpicture}[remember picture,overlay]
      \node[circle, fill=templatePrimary!12, minimum size=13cm] at ([xshift=-4cm,yshift=4.5cm]current page.north east) {};
      \node[rectangle, fill=templateAccent!8, minimum width=19cm, minimum height=5.5cm, rounded corners=18pt] at ([yshift=-0.5cm]current page.center) {};
      \node[circle, fill=templateGold!15, minimum size=7cm] at ([xshift=5.5cm,yshift=-8.5cm]current page.south west) {};
  \end{tikzpicture}
  
  % Skip logo space since we don't have logos in our system
  \vspace{2cm}
  
  % Institutional Information (from raw3)
  \begin{center}
  \begin{tcolorbox}[colback=white,colframe=templatePrimary,width=0.82\textwidth,arc=6pt,boxrule=1.8pt]
  \centering
  {\Large\textbf{\textcolor{templatePrimary}{\InstitutionPlaceholder}}}\\[0.3cm]
  {\large\textcolor{templateDark}{\DepartmentPlaceholder}}\\[0.15cm]
  {\normalsize\textcolor{templateDark}{Research \& Development Division}}
  \end{tcolorbox}
  \end{center}
  
  \vspace{1.8cm}
  
  % Document Type (from raw3)
  \begin{center}
  {\LARGE\textcolor{templateAccent}{\textit{#2}}}
  \end{center}
  
  \vspace{2cm}
  
  % Project Title (from raw3)
  \begin{center}
  {\huge\textbf{\textcolor{templatePrimary}{#1}}}\\[0.6cm]
  {\Large\textit{\textcolor{templateAccent}{Advanced Research Document}}}
  \end{center}
  
  \vspace{2.2cm}
  
  % Author Information (from raw3)
  \begin{center}
  \begin{tcolorbox}[colback=templateGold!5,colframe=templateGold!60,width=0.75\textwidth,arc=5pt,boxrule=1.2pt]
  \centering
  \textbf{\large Document Information}\\[0.4cm]
  \begin{tabular}{l}
  \textbf{Prepared by:} #5 \\[0.15cm]
  \textbf{Document ID:} \DocumentIDPlaceholder \\[0.15cm]
  \textbf{Version:} \VersionPlaceholder \\[0.3cm]
  \end{tabular}\\
  \textit{\textcolor{templateDark}{Date: #3}}
  \end{tcolorbox}
  \end{center}
  
  \vspace{1.8cm}
  
  % Classification Information (from raw3)
  \begin{center}
  \textbf{\Large\textcolor{templatePrimary}{Document Classification}}\\[0.5cm]
  \begin{tabular}{p{0.44\textwidth}p{0.44\textwidth}}
  \textbf{Classification:} & \textbf{Distribution:} \\[0.2cm]
  \ClassificationPlaceholder & \DistributionPlaceholder \\[0.3cm]
  \textbf{Status:} & \textbf{Contact:} \\[0.2cm]
  \StatusPlaceholder & \ContactPlaceholder \\
  \end{tabular}
  \end{center}
  
  \vfill
  
  % Footer Information (from raw3)
  \begin{center}
  \colorbox{templateLight}{\makebox[0.85\textwidth]{\textbf{\InstitutionPlaceholder\ - \ClassificationPlaceholder\ Document}}}
  \end{center}
  
  \end{titlepage}
  \restoregeometry
}

% ========== TABLE STYLE ==========
% Define the table style that uses template colors (from raw3)
\newcommand{\templateFourTable}{
  \rowcolors{2}{templatePrimary!15}{templateLight}
  \arrayrulecolor{templatePrimary!60}
  \renewcommand{\arraystretch}{1.3}
}

% ========== HYPERREF INTEGRATION ==========
% Enhanced hyperlink styling (if hyperref is loaded) - from raw3
% Note: This is handled by the modules system, so we don't override it here